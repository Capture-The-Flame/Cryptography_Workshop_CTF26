<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hash Functions - Cryptography Workshop</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <i class="fas fa-lock me-2"></i>
        <span>Cryptography Workshop</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" 
              aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="index.html">
              <i class="fas fa-home me-1"></i> Home
            </a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="modulesDropdown" 
               role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-book me-1"></i> Modules
            </a>
            <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="modulesDropdown">
              <li>
                <h6 class="dropdown-header text-uppercase fw-bold">Cryptography Modules</h6>
              </li>
              <li><a class="dropdown-item" href="docs/symmetric-crypto.html">
                <i class="fas fa-exchange-alt me-2"></i>Symmetric Cryptography</a>
              </li>
              <li><a class="dropdown-item" href="docs/public-key-crypto.html">
                <i class="fas fa-key me-2"></i>Public Key Cryptography</a>
              </li>
              <li><a class="dropdown-item" href="docs/hash-functions.html">
                <i class="fas fa-hashtag me-2"></i>Hash Functions</a>
              </li>
              <li><a class="dropdown-item" href="docs/post-quantum-crypto.html">
                <i class="fas fa-atom me-2"></i>Post-Quantum Crypto</a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="docs/ctf-guide.html">Challenge Guide</a>
          </li>
        </ul>
        <form class="d-flex">
          <div class="input-group">
            <input class="form-control bg-dark text-white border-secondary" type="search" 
                   placeholder="Search..." aria-label="Search">
            <button class="btn btn-outline-light" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </form>
      </div>
    </div>
  </nav>

  <main class="container">
    <div class="markdown-body">
      <h1 id="modern-hash-functions">Modern Hash Functions</h1>
<p>Hash functions are fundamental building blocks in modern cryptography, providing data integrity, message authentication, and digital signatures. This section covers secure hash functions, their properties, and best practices for implementation.</p>
<h2 id="properties-of-cryptographic-hash-functions">Properties of Cryptographic Hash Functions</h2>
<p>A secure cryptographic hash function must satisfy these properties:</p>
<ol>
<li><strong>Deterministic</strong>: Same input always produces the same hash</li>
<li><strong>Fast Computation</strong>: Hash can be computed quickly</li>
<li><strong>Pre-image Resistance</strong>: Infeasible to reverse the hash to find the original input</li>
<li><strong>Second Pre-image Resistance</strong>: Given an input, it’s infeasible to find another input with the same hash</li>
<li><strong>Collision Resistance</strong>: Infeasible to find two different inputs that produce the same hash</li>
<li><strong>Avalanche Effect</strong>: Small changes in input cause significant changes in output</li>
</ol>
<h2 id="common-hash-functions">Common Hash Functions</h2>
<h3 id="sha-2-family">SHA-2 Family</h3>
<ul>
<li><strong>SHA-256</strong>: 256-bit output, widely used in blockchain and TLS</li>
<li><strong>SHA-384/SHA-512</strong>: Stronger variants with larger output sizes</li>
</ul>
<h3 id="sha-3-keccak">SHA-3 (Keccak)</h3>
<ul>
<li>NIST standard based on the Keccak algorithm</li>
<li>Different design from SHA-2 (sponge construction)</li>
<li>Resistant to length-extension attacks</li>
<li>Variants: SHA3-224, SHA3-256, SHA3-384, SHA3-512</li>
</ul>
<h3 id="blake3">BLAKE3</h3>
<ul>
<li>Modern, high-performance hash function</li>
<li>Parallelizable and extremely fast</li>
<li>256-bit output by default</li>
<li>Used in IPFS and other modern systems</li>
</ul>
<h2 id="implementation-examples">Implementation Examples</h2>
<h3 id="python-using-hashlib">Python: Using hashlib</h3>
<pre><code class="language-python"><span class="hljs-keyword">import</span> hashlib

<span class="hljs-keyword">def</span> <span class="hljs-title function_">hash_sha256</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">&quot;&quot;&quot;Generate SHA-256 hash of input data.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> hashlib.sha256(data).hexdigest()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">hash_sha3_256</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">&quot;&quot;&quot;Generate SHA3-256 hash of input data.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> hashlib.sha3_256(data).hexdigest()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">hash_blake2s</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">&quot;&quot;&quot;Generate BLAKE2s hash of input data.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> hashlib.blake2s(data).hexdigest()
</code></pre>
<h3 id="go-using-standard-library">Go: Using Standard Library</h3>
<pre><code class="language-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;crypto/sha256&quot;</span>
    <span class="hljs-string">&quot;crypto/sha512&quot;</span>
    <span class="hljs-string">&quot;encoding/hex&quot;</span>
    <span class="hljs-string">&quot;golang.org/x/crypto/blake2b&quot;</span>
    <span class="hljs-string">&quot;golang.org/x/crypto/sha3&quot;</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SHA256Hash</span><span class="hljs-params">(data []<span class="hljs-type">byte</span>)</span></span> <span class="hljs-type">string</span> {
    hash := sha256.Sum256(data)
    <span class="hljs-keyword">return</span> hex.EncodeToString(hash[:])
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SHA3512Hash</span><span class="hljs-params">(data []<span class="hljs-type">byte</span>)</span></span> <span class="hljs-type">string</span> {
    hash := sha3.New512()
    hash.Write(data)
    <span class="hljs-keyword">return</span> hex.EncodeToString(hash.Sum(<span class="hljs-literal">nil</span>))
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BLAKE2b512Hash</span><span class="hljs-params">(data []<span class="hljs-type">byte</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
    hash, err := blake2b.New512(<span class="hljs-literal">nil</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err
    }
    hash.Write(data)
    <span class="hljs-keyword">return</span> hex.EncodeToString(hash.Sum(<span class="hljs-literal">nil</span>)), <span class="hljs-literal">nil</span>
}
</code></pre>
<h3 id="c-using-openssl">C: Using OpenSSL</h3>
<pre><code class="language-c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/sha.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/evp.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">sha256_hash</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data, <span class="hljs-type">size_t</span> len, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *output)</span> {
    SHA256_CTX sha256;
    SHA256_Init(&amp;sha256);
    SHA256_Update(&amp;sha256, data, len);
    SHA256_Final(output, &amp;sha256);
}

<span class="hljs-type">void</span> <span class="hljs-title function_">sha3_256_hash</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *data, <span class="hljs-type">size_t</span> len, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *output)</span> {
    EVP_MD_CTX *mdctx;
    <span class="hljs-type">const</span> EVP_MD *md = EVP_sha3_256();
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> md_len;

    mdctx = EVP_MD_CTX_new();
    EVP_DigestInit_ex(mdctx, md, <span class="hljs-literal">NULL</span>);
    EVP_DigestUpdate(mdctx, data, len);
    EVP_DigestFinal_ex(mdctx, output, &amp;md_len);
    EVP_MD_CTX_free(mdctx);
}
</code></pre>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="common-vulnerabilities">Common Vulnerabilities</h3>
<ol>
<li><p><strong>Length Extension Attacks</strong>: Affects Merkle-Damgård constructions (MD5, SHA-1, SHA-256)</p>
<ul>
<li>Mitigation: Use HMAC or SHA-3</li>
</ul>
</li>
<li><p><strong>Collision Attacks</strong>: Finding two inputs with the same hash</p>
<ul>
<li>MD5 and SHA-1 are considered broken for security-critical applications</li>
</ul>
</li>
<li><p><strong>Timing Attacks</strong>: Side-channel attacks based on execution time</p>
<ul>
<li>Use constant-time comparison functions</li>
</ul>
</li>
</ol>
<h3 id="best-practices">Best Practices</h3>
<ol>
<li><strong>Use Modern Hash Functions</strong>: Prefer SHA-3 or BLAKE3 for new applications</li>
<li><strong>Use Appropriate Output Size</strong>: At least 256 bits for collision resistance</li>
<li><strong>Always Use Salt</strong>: For password hashing, always use a unique salt</li>
<li><strong>Use Keyed Hashes</strong>: HMAC or KMAC for message authentication</li>
<li><strong>Consider Memory Hardness</strong>: For password hashing, use Argon2, bcrypt, or scrypt</li>
</ol>
<h2 id="performance-comparison">Performance Comparison</h2>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Speed (MB/s)</th>
<th>Security Bits</th>
<th>Best For</th>
</tr>
</thead>
<tbody><tr>
<td>SHA-256</td>
<td>300-500</td>
<td>128</td>
<td>General purpose, blockchain</td>
</tr>
<tr>
<td>SHA3-256</td>
<td>200-400</td>
<td>128</td>
<td>Security-critical applications</td>
</tr>
<tr>
<td>BLAKE3</td>
<td>1000-2000</td>
<td>128</td>
<td>High-performance applications</td>
</tr>
<tr>
<td>BLAKE2b-512</td>
<td>500-1000</td>
<td>256</td>
<td>Cryptocurrency, security</td>
</tr>
<tr>
<td>MD5</td>
<td>1000+</td>
<td>&lt; 64 (broken)</td>
<td>Non-cryptographic use only</td>
</tr>
</tbody></table>
<h2 id="password-hashing">Password Hashing</h2>
<h3 id="using-argon2-recommended">Using Argon2 (Recommended)</h3>
<pre><code class="language-python"><span class="hljs-keyword">import</span> argon2

<span class="hljs-keyword">def</span> <span class="hljs-title function_">hash_password</span>(<span class="hljs-params">password: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">&quot;&quot;&quot;Hash a password using Argon2.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> argon2.PasswordHasher().<span class="hljs-built_in">hash</span>(password)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_password</span>(<span class="hljs-params">hashed: <span class="hljs-built_in">str</span>, password: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">&quot;&quot;&quot;Verify a password against a hash.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">return</span> argon2.PasswordHasher().verify(hashed, password)
    <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h3 id="using-bcrypt">Using bcrypt</h3>
<pre><code class="language-python"><span class="hljs-keyword">import</span> bcrypt

<span class="hljs-keyword">def</span> <span class="hljs-title function_">hash_password_bcrypt</span>(<span class="hljs-params">password: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:
    <span class="hljs-string">&quot;&quot;&quot;Hash a password using bcrypt.&quot;&quot;&quot;</span>
    salt = bcrypt.gensalt()
    <span class="hljs-keyword">return</span> bcrypt.hashpw(password.encode(), salt)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_password_bcrypt</span>(<span class="hljs-params">hashed: <span class="hljs-built_in">bytes</span>, password: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">&quot;&quot;&quot;Verify a password against a bcrypt hash.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> bcrypt.checkpw(password.encode(), hashed)
</code></pre>
<h2 id="key-derivation-functions-kdfs">Key Derivation Functions (KDFs)</h2>
<h3 id="pbkdf2">PBKDF2</h3>
<pre><code class="language-python"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> os

<span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_key</span>(<span class="hljs-params">password: <span class="hljs-built_in">str</span>, salt: <span class="hljs-built_in">bytes</span> = <span class="hljs-literal">None</span>, iterations: <span class="hljs-built_in">int</span> = <span class="hljs-number">100000</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-built_in">bytes</span>, <span class="hljs-built_in">bytes</span>]:
    <span class="hljs-string">&quot;&quot;&quot;Derive a key using PBKDF2-HMAC-SHA256.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">if</span> salt <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        salt = os.urandom(<span class="hljs-number">16</span>)  <span class="hljs-comment"># 16 bytes = 128 bits</span>
    
    key = hashlib.pbkdf2_hmac(
        <span class="hljs-string">&#x27;sha256&#x27;</span>,
        password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>),
        salt,
        iterations
    )
    
    <span class="hljs-keyword">return</span> key, salt
</code></pre>
<h3 id="scrypt">Scrypt</h3>
<pre><code class="language-python"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> os

<span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_key_scrypt</span>(<span class="hljs-params">password: <span class="hljs-built_in">str</span>, salt: <span class="hljs-built_in">bytes</span> = <span class="hljs-literal">None</span>, N: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>**<span class="hljs-number">14</span>, r: <span class="hljs-built_in">int</span> = <span class="hljs-number">8</span>, p: <span class="hljs-built_in">int</span> = <span class="hljs-number">1</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-built_in">bytes</span>, <span class="hljs-built_in">bytes</span>]:
    <span class="hljs-string">&quot;&quot;&quot;Derive a key using scrypt.&quot;&quot;&quot;</span>
    <span class="hljs-keyword">if</span> salt <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        salt = os.urandom(<span class="hljs-number">16</span>)
    
    key = hashlib.scrypt(
        password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>),
        salt=salt,
        n=N,  <span class="hljs-comment"># CPU/memory cost</span>
        r=r,  <span class="hljs-comment"># block size</span>
        p=p   <span class="hljs-comment"># parallelization factor</span>
    )
    
    <span class="hljs-keyword">return</span> key, salt
</code></pre>
<h2 id="real-world-applications">Real-world Applications</h2>
<ol>
<li><strong>Digital Signatures</strong>: Hash the message before signing</li>
<li><strong>Password Storage</strong>: Store only hashed passwords</li>
<li><strong>Data Integrity</strong>: Verify file integrity with checksums</li>
<li><strong>Blockchain</strong>: Transaction hashing and proof-of-work</li>
<li><strong>Merkle Trees</strong>: Efficient data verification in distributed systems</li>
</ol>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">NIST FIPS 180-4: Secure Hash Standard</a></li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">NIST FIPS 202: SHA-3 Standard</a></li>
<li><a href="https://tools.ietf.org/html/rfc7693">RFC 7693: The BLAKE2 Cryptographic Hash and Message Authentication Code</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP Password Storage Cheat Sheet</a></li>
<li><a href="https://github.com/P-H-C/phc-winner-argon2">Argon2: The Memory-Hard Function for Password Hashing</a></li>
</ul>

    </div>
  </main>

  <footer class="bg-dark-footer text-white-footer text-center py-3 mt-5">
    <div class="card-header bg-dark-footer">
      <p class="mb-0">&copy; 2025 Lily Gross. All rights reserved.</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</body>
</html>